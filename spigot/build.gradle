plugins {
    id 'java'
    id 'com.github.johnrengelman.shadow' version '7.0.0'
}

configurations {
    resolvedImplementation.extendsFrom implementation
}

dependencies {
    implementation project(':common')
    compileOnly 'org.spigotmc:spigot-api:1.16.4-R0.1-SNAPSHOT'
    compileOnly "com.github.MilkBowl:VaultAPI:1.7"
    compileOnly 'io.lumine:Mythic-Dist:5.3.5'
    compileOnly 'me.clip:placeholderapi:2.10.0'
    implementation 'net.kyori:adventure-platform-bukkit:4.3.1'
    implementation 'net.wesjd:anvilgui:1.9.2-SNAPSHOT'
}

tasks {
    jar {
        enabled = false
    }

    shadowJar {
        configurations = [project.configurations.resolvedImplementation]
        minimize()
    }

    processResources {
        mustRunAfter 'compileJava'
        filesMatching(["plugin.yml"]) {
            expand(version: project.version, displayName: project.property("name"))
        }
    }

    shadowJar.dependsOn subprojects*.tasks*.withType(JavaCompile)
}
