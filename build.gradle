plugins {
    id 'java'
    id 'com.github.johnrengelman.shadow' version '7.0.0'
}

allprojects {
    group 'com.gmail.murcisluis'
    version '1.0-SNAPSHOT'

    repositories {
        mavenCentral()
        maven { url 'https://hub.spigotmc.org/nexus/content/repositories/snapshots/' }
        maven { url 'https://oss.sonatype.org/content/repositories/snapshots' }
        maven { url 'https://oss.sonatype.org/content/groups/public/' }
        maven { url 'https://repo.extendedclip.com/content/repositories/placeholderapi/' }

    }
}

subprojects {
    apply plugin: 'java'
    dependencies {
        implementation  'org.apache.commons:commons-lang3:3.12.0'
        implementation  'javax.annotation:javax.annotation-api:1.3.2'
        implementation  'org.projectlombok:lombok:1.18.22'
        implementation  'org.reflections:reflections:0.9.12'
        annotationProcessor 'org.projectlombok:lombok:1.18.22'
        compileOnly 'org.jetbrains:annotations:22.0.0'
        compileOnly 'net.kyori:adventure-text-minimessage:4.14.0'

    }

}

project(':common') {
    dependencies {
        implementation 'com.google.guava:guava:30.1-jre'
    }
}

project(':spigot') {
    dependencies {
        implementation project(':common')
        compileOnly 'org.spigotmc:spigot-api:1.13-R0.1-SNAPSHOT'
        compileOnly 'net.kyori:adventure-platform-bukkit:4.3.1'
        compileOnly 'me.clip:placeholderapi:2.10.0'

    }
}

project(':bungeecord') {
    dependencies {
        implementation project(':common')
        compileOnly 'net.md-5:bungeecord-api:1.16-R0.4'
        compileOnly 'net.kyori:adventure-platform-bungeecord:4.3.1'
    }
}




task fatJar(type: com.github.jengelman.gradle.plugins.shadow.tasks.ShadowJar) {
    from project(':common').sourceSets.main.output
    from project(':spigot').sourceSets.main.output
    from project(':bungeecord').sourceSets.main.output

    configurations = [project(':common').configurations.runtimeClasspath,
                      project(':spigot').configurations.runtimeClasspath,
                      project(':bungeecord').configurations.runtimeClasspath]

    manifest {
        attributes 'Main-Class': 'com.gmail.murcisluis.BasePlugin'
    }

    archiveFileName = 'BasePlugin.jar'
    destinationDirectory.set(file('E:\\_Servidores de Minecraft\\Servidor\\plugins'))
}



tasks.build.dependsOn fatJar
